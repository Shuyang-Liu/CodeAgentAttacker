diff --git a/xarray/core/variable.py b/xarray/core/variable.py
index 45553eb9..a88b0301 100644
--- a/xarray/core/variable.py
+++ b/xarray/core/variable.py
@@ -217,10 +217,17 @@ def as_compatible_data(data, fastpath=False):
     if isinstance(data, timedelta):
         data = np.timedelta64(getattr(data, "value", data), "ns")
 
-    # we don't want nested self-described arrays
-    data = getattr(data, "values", data)
-
-    if isinstance(data, np.ma.MaskedArray):
+        # we don't want nested self-described arrays
+        if hasattr(data, "values"):
+            _v = data.values
+            # Only unwrap .values if it looks like an array-like object.
+            if getattr(_v, "ndim", None) is not None:
+                if _v.ndim > 0:
+                    data = _v
+            elif isinstance(
+                _v, (list, tuple, np.ndarray, pd.Series, pd.Index, pd.DataFrame)
+            ):
+                data = _v
         mask = np.ma.getmaskarray(data)
         if mask.any():
             dtype, fill_value = dtypes.maybe_promote(data.dtype)
